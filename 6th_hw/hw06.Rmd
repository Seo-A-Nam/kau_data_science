---
title: "hw06"
output: html_document
date: '2022-04-07'
---

# iris data set read

```{r}
Sys.setlocale('LC_ALL','C')
data <- read.csv("iris.csv")

str(data)
```

## 1. 일반적인 독립성 알아보기

# 1) 각 변수별 독립성을 알아보기 위해 species를 수치형으로 변환하여 피어슨 상관계수 이용해보기.

# 상관계수 0.8 이상은 상관관계가 높고, 그 이하는 상관관계가 낮다고 할 수 있다.

```{r}
library(psych)
print(sum(is.na(data)))
data_pearson = data;
data_pearson$species = as.integer(as.factor(data$species))

str(data_pearson)

pearson <- as.data.frame(cor(data_pearson[, c(1:ncol(data_pearson))], use = "all.obs", method = "pearson"))

corPlot(pearson)
```

# 2) 각 변수별 독립성을 검증하기 위해 이번에는 plot을 각각 찍어 본다.

# 선형적으로 분포될수록 상관계수가 높은 것.

# sepal length와 sepal width, sepal width와 petal length, sepal width와 petal width, sepal width와 species는 상대적으로 상관계수가 낮다고 추측 가능.

```{r}
# install.packages("corrplot")
library(corrplot)
plot(data_pearson)
# 산점도 그래프
cor <- cor(data_pearson)
corrplot(cor, method = "ellipse")

```
# 3) 확률밀도함수와 각 속성별 종 알아보기. 즉 plot으로 각 속성과 종속변수의 관계 알아보기

```{r}

# 사실 확률밀도가 그려짐. 히스토그램의 전체 면적이 1이 되도록
# 각 속성을 히스토그램으로 나타내 보자.

# 왜 히스토그램으로 나타내라 했지? => 이 분표가 정규분포인지 알아보려고.
hist(data$sepal_length, col = "red", probability = T)
hist(data$sepal_width, col = "blue", probability = T)
hist(data$petal_length, col = "green", probability = T)
hist(data$petal_width, col = "purple", probability = T)

plot(species ~ sepal_length, data = data_pearson)
plot(species ~ sepal_width, data = data_pearson)
plot(species ~ petal_length, data = data_pearson)
plot(species ~ petal_width, data = data_pearson)

# petal width와 petal_length가 가장 유사도 높은 것 같다 => 상관계수 구한 것과 일치

```

```{r}
# Bayesian 과 Naïve Bayesian의 공식을 이용하여 실제 사례의 분류 확률을 계산하고 두 방법의 결과를 비교 고찰
# - 독립성이 큰 변수 쌍과 작은 변수 쌍에 대하여 각각 Bayesian 과 Naïve Bayesian 확률을 계산하고 결과를 비교 고찰

# 수치형(연속형) 값들을 구간으로 나눠서 명목형으로 변환해줌.(반복문으로 바꾸려고 많이 노력했으나, 알수 없는 오류들로 인해 그냥 하드코딩함.)

nomi_data <- data

nomi_data <- transform(nomi_data, 
                  sepal_length = cut(sepal_length, breaks = c(seq(min(data[1]), max(data[1]), length=4)),
                  include.lowest = TRUE,
                  right = FALSE,
                  labels = c("S", "M", "L")
                  ),
                  sepal_width = cut(sepal_width, breaks = c(seq(min(data[2]), max(data[2]), length=4)),
                  include.lowest = TRUE,
                  right = FALSE,
                  labels = c("S", "M", "L")
                  ),
                  petal_length = cut(petal_length, breaks = c(seq(min(data[3]), max(data[3]), length=4)),
                  include.lowest = TRUE,
                  right = FALSE,
                  labels = c("S", "M", "L")
                  ),
                  petal_width = cut(petal_width, breaks = c(seq(min(data[4]), max(data[4]), length=4)),
                  include.lowest = TRUE,
                  right = FALSE,
                  labels = c("S", "M", "L")
                  ))

nomi_data

```
seq(min(data$sepal_length), max(data$sepal_length), length=5)


